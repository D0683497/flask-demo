{% extends "layout.html" %}

{% import "post_pagination.html" as macros %}

{% block content %}
<div class="container">
    {% for message in get_flashed_messages(category_filter=["success"]) %}
    <div class="alert alert-success alert-dismissible fade show" role="alert">
        <strong>{{ message }}</strong>
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    {% endfor %}

    {% for message in get_flashed_messages(category_filter=["warning"]) %}
    <div class="alert alert-warning alert-dismissible fade show" role="alert">
        <strong>{{ message }}</strong>
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    {% endfor %}

    <div class="jumbotron p-3 p-md-5 text-white rounded bg-dark">
        <div class="col-md-6 px-0">
            <h1 class="display-4 font-italic">逢甲 - 軟體工程</h1>
            <p class="lead my-3">軟體工程 demo 網站</p>
            <p class="lead mb-0"><a href="{{ url_for('auth.regist') }}" class="text-white font-weight-bold">立即註冊</a></p>
        </div>
    </div>

    <form class="form-regist" method="POST">
        {{ form.hidden_tag() }}
        <div class="form-group">
            {{ form.body.label }}
            {{ form.body() }}
        </div>

        {{ form.submit() }}
    </form>

    <div class="post-tabs">
        <ul class="nav nav-tabs">
            <li class="nav-item">
                <a href="{{ url_for('main.show_all') }}" {% if not show_followed %} class="active nav-link" {% else %} class="nav-link" {% endif %}>All</a>
            </li>
            {% if current_user.is_authenticated %}
            <li class="nav-item">
                <a href="{{ url_for('main.show_followed') }}" {% if show_followed %} class="active nav-link" {% else %} class="nav-link" {% endif %}>Followers</a>
            </li>
            {% endif %}
        </ul>

        {% for post in posts %}
        <div class="card">
            <div class="card-header">
                <a href="{{ url_for('main.user', username=post.author.username) }}">{{ post.author.username }}</a>
            </div>
            <div class="card-body">
                {{ post.body }}
            </div>
        </div>
        {% endfor %}

    </div>

    {% if pagination %}
    <nav aria-label="Page navigation">
        {{ macros.pagination_widget(pagination, 'main.index') }}
    </nav>
    {% endif %}

</div>

{% endblock %}